import pandas as pd
import argparse
import os

def extract_samples(input_file, family, output_dir=None):
    # Načítanie CSV súboru
    df = pd.read_csv(input_file)

    # Filtrovanie podľa rodiny
    family_df = df[df['Family'] == family]

    # Ak počet vzoriek presahuje 1000, náhodne vyberte 1000 vzoriek
    if len(family_df) > 1000:
        family_df = family_df.sample(n=1000, random_state=42)

    # Ak nie je výstupný adresár, použije sa adresár z input_file
    if output_dir is None:
        output_dir = os.path.dirname(input_file)

    # Vytvorenie názvu výstupného súboru
    input_filename = os.path.basename(input_file)
    output_filename = f"{os.path.splitext(input_filename)[0]}_{family}_extracted_1000_samples.csv"
    output_path = os.path.join(output_dir, output_filename)

    # Uloženie do nového CSV súboru
    family_df.to_csv(output_path, index=False)
    print(f"Uložené do súboru: {output_path}")

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Extrahuje 1000 vzoriek z datasetu podľa rodiny.")
    parser.add_argument("-i", "--input", required=True, help="Názov vstupného CSV súboru.")
    parser.add_argument("-f", "--family", required=True, help="Názov rodiny.")
    parser.add_argument("-o", "--output_dir", help="Cesta k výstupnému adresáru (voliteľné).")

    args = parser.parse_args()

    extract_samples(args.input, args.family, args.output_dir)
